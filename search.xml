<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>工具类开发之公共方法集合</title>
      <link href="20210210/utils/"/>
      <url>20210210/utils/</url>
      
        <content type="html"><![CDATA[<h1 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h1><p>经常用到的方法，记录下来，方便使用</p><h1 id="具体如下"><a href="#具体如下" class="headerlink" title="具体如下"></a>具体如下</h1><h2 id="判断数组包含"><a href="#判断数组包含" class="headerlink" title="判断数组包含"></a>判断数组包含</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.contains = <span class="function"><span class="keyword">function</span> (<span class="params"> needle </span>) </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (i <span class="keyword">in</span> <span class="built_in">this</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">this</span>[i] == needle) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="判断字符串包含"><a href="#判断字符串包含" class="headerlink" title="判断字符串包含"></a>判断字符串包含</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">String</span>.prototype.contains = <span class="function"><span class="keyword">function</span> (<span class="params"> needle </span>) </span>&#123;</span><br><span class="line"><span class="keyword">var</span> result= <span class="built_in">this</span>.indexOf(needle)&gt;-<span class="number">1</span>?<span class="literal">true</span>:<span class="literal">false</span>;</span><br><span class="line"><span class="keyword">return</span> result;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="以什么结尾"><a href="#以什么结尾" class="headerlink" title="以什么结尾"></a>以什么结尾</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">String</span>.prototype.endWith=<span class="function"><span class="keyword">function</span>(<span class="params">endStr</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> d=<span class="built_in">this</span>.length-endStr.length;</span><br><span class="line">    <span class="keyword">return</span> (d&gt;=<span class="number">0</span>&amp;&amp;<span class="built_in">this</span>.lastIndexOf(endStr)==d);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="时间转换"><a href="#时间转换" class="headerlink" title="时间转换"></a>时间转换</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add0</span>(<span class="params">m</span>) </span>&#123;<span class="keyword">return</span> m &lt; <span class="number">10</span> ? <span class="string">&#x27;0&#x27;</span> + m : m;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">formatTime</span>(<span class="params">timestamp</span>) </span>&#123;</span><br><span class="line"><span class="keyword">var</span> time=<span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line"><span class="function"><span class="title">if</span>(<span class="params">timestamp</span>)</span>&#123;</span><br><span class="line">time=<span class="keyword">new</span> <span class="built_in">Date</span>(timestamp)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> y = time.getFullYear();</span><br><span class="line"><span class="keyword">var</span> m = time.getMonth() + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">var</span> d = time.getDate();</span><br><span class="line"><span class="keyword">var</span> h=time.getHours();</span><br><span class="line"><span class="keyword">var</span> mm=time.getMinutes();</span><br><span class="line"><span class="keyword">var</span> s=time.getSeconds();</span><br><span class="line"><span class="keyword">return</span> y + <span class="string">&#x27;-&#x27;</span> + add0(m) + <span class="string">&#x27;-&#x27;</span> + add0(d)+<span class="string">&quot; &quot;</span>+add0(h)+<span class="string">&quot;:&quot;</span>+add0(mm)+<span class="string">&quot;:&quot;</span>+add0(s);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="是否是数字"><a href="#是否是数字" class="headerlink" title="是否是数字"></a>是否是数字</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isRealNum</span>(<span class="params">val</span>)</span>&#123;</span><br><span class="line"><span class="comment">// isNaN()函数 把空串 空格 以及NUll 按照0来处理 所以先去除</span></span><br><span class="line"><span class="function"><span class="title">if</span>(<span class="params">val === <span class="string">&quot;&quot;</span> || val ==<span class="literal">null</span></span>)</span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="title">if</span>(<span class="params">!<span class="built_in">isNaN</span>(val)</span>)</span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="去掉前后空格"><a href="#去掉前后空格" class="headerlink" title="去掉前后空格"></a>去掉前后空格</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">String</span>.prototype.Trim = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;  </span><br><span class="line"><span class="keyword">return</span> <span class="built_in">this</span>.replace(<span class="regexp">/(^\s*)|(\s*$)/g</span>, <span class="string">&quot;&quot;</span>);  </span><br><span class="line">&#125; ;</span><br><span class="line"><span class="comment">//去掉左边空格</span></span><br><span class="line"><span class="built_in">String</span>.prototype.LTrim = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;  </span><br><span class="line"><span class="keyword">return</span> <span class="built_in">this</span>.replace(<span class="regexp">/(^\s*)/g</span>, <span class="string">&quot;&quot;</span>);  </span><br><span class="line">&#125; ; </span><br><span class="line"><span class="comment">//去掉右边空格</span></span><br><span class="line"><span class="built_in">String</span>.prototype.RTrim = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;  </span><br><span class="line"><span class="keyword">return</span> <span class="built_in">this</span>.replace(<span class="regexp">/(\s*$)/g</span>, <span class="string">&quot;&quot;</span>);  </span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="字符串大小写转换"><a href="#字符串大小写转换" class="headerlink" title="字符串大小写转换"></a>字符串大小写转换</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 大小写转换</span></span><br><span class="line"><span class="comment"> * 1:首字母大写 2:首页母小写 3:大小写转换 4:全部大写 5:全部小写</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">changeCase</span>(<span class="params">str, type</span>) </span>&#123;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ToggleCase</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line"><span class="keyword">var</span> itemText = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">str.split(<span class="string">&#x27;&#x27;</span>).forEach(</span><br><span class="line"><span class="function"><span class="keyword">function</span> (<span class="params">item</span>) </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="regexp">/^([a-z]+)/</span>.test(item)) &#123;</span><br><span class="line">itemText += item.toUpperCase();</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="regexp">/^([A-Z]+)/</span>.test(item)) &#123;</span><br><span class="line">itemText += item.toLowerCase();</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">itemText += item;</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">return</span> itemText;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">switch</span> (type) &#123;</span><br><span class="line"><span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line"><span class="keyword">return</span> str.replace(<span class="regexp">/^(\w)(\w+)/</span>, <span class="function"><span class="keyword">function</span> (<span class="params">v, v1, v2</span>) </span>&#123;</span><br><span class="line"><span class="keyword">return</span> v1.toUpperCase() + v2.toLowerCase()</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line"><span class="keyword">return</span> str.replace(<span class="regexp">/^(\w)(\w+)/</span>, <span class="function"><span class="keyword">function</span> (<span class="params">v, v1, v2</span>) </span>&#123;</span><br><span class="line"><span class="keyword">return</span> v1.toLowerCase() + v2.toUpperCase()</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line"><span class="keyword">return</span> ToggleCase(str);</span><br><span class="line"><span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line"><span class="keyword">return</span> str.toUpperCase();</span><br><span class="line"><span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line"><span class="keyword">return</span> str.toLowerCase();</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line"><span class="keyword">return</span> str;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="拷贝对象字段数据"><a href="#拷贝对象字段数据" class="headerlink" title="拷贝对象字段数据"></a>拷贝对象字段数据</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">copyObjectField</span>(<span class="params">oldArray,newArray</span>)</span>&#123;</span><br><span class="line"><span class="keyword">var</span> obj=&#123;&#125;;</span><br><span class="line"><span class="keyword">var</span> fields=<span class="built_in">Object</span>.keys(newArray);</span><br><span class="line"><span class="function"><span class="title">for</span>(<span class="params"><span class="keyword">var</span> i=<span class="number">0</span>;i&lt;fields.length;i++</span>)</span>&#123;</span><br><span class="line"><span class="function"><span class="title">if</span>(<span class="params">!newArray[fields[i]]</span>)</span>&#123;</span><br><span class="line">obj[fields[i]]=oldArray[fields[i]];</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">obj[fields[i]]=newArray[fields[i]];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> obj;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="获取操作系统"><a href="#获取操作系统" class="headerlink" title="获取操作系统"></a>获取操作系统</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">detectOS</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="keyword">var</span> sUserAgent = navigator.userAgent;</span><br><span class="line"><span class="keyword">var</span> isWin = (navigator.platform == <span class="string">&quot;Win32&quot;</span>) || (navigator.platform == <span class="string">&quot;Windows&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> isMac = (navigator.platform == <span class="string">&quot;Mac68K&quot;</span>) || (navigator.platform == <span class="string">&quot;MacPPC&quot;</span>) || (navigator.platform == <span class="string">&quot;Macintosh&quot;</span>) || (navigator.platform == <span class="string">&quot;MacIntel&quot;</span>);</span><br><span class="line"><span class="keyword">if</span> (isMac) <span class="keyword">return</span> <span class="string">&quot;Mac&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> isUnix = (navigator.platform == <span class="string">&quot;X11&quot;</span>) &amp;&amp; !isWin &amp;&amp; !isMac;</span><br><span class="line"><span class="keyword">if</span> (isUnix) <span class="keyword">return</span> <span class="string">&quot;Unix&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> isLinux = (<span class="built_in">String</span>(navigator.platform).indexOf(<span class="string">&quot;Linux&quot;</span>) &gt; -<span class="number">1</span>);</span><br><span class="line"><span class="keyword">if</span> (isLinux) <span class="keyword">return</span> <span class="string">&quot;Linux&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (isWin) &#123;</span><br><span class="line"><span class="keyword">var</span> isWin2K = sUserAgent.indexOf(<span class="string">&quot;Windows NT 5.0&quot;</span>) &gt; -<span class="number">1</span> ||sUserAgent.indexOf(<span class="string">&quot;Windows 2000&quot;</span>) &gt; -<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (isWin2K) <span class="keyword">return</span> <span class="string">&quot;Win2000&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> isWinXP = sUserAgent.indexOf(<span class="string">&quot;Windows NT 5.1&quot;</span>) &gt; -<span class="number">1</span> || sUserAgent.indexOf(<span class="string">&quot;Windows XP&quot;</span>) &gt; -<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (isWinXP) <span class="keyword">return</span> <span class="string">&quot;WinXP&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> isWin2003 = sUserAgent.indexOf(<span class="string">&quot;Windows NT 5.2&quot;</span>) &gt; -<span class="number">1</span> || sUserAgent.indexOf(<span class="string">&quot;Windows 2003&quot;</span>) &gt; -<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (isWin2003) <span class="keyword">return</span> <span class="string">&quot;Win2003&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> isWinVista= sUserAgent.indexOf(<span class="string">&quot;Windows NT 6.0&quot;</span>) &gt; -<span class="number">1</span> || sUserAgent.indexOf(<span class="string">&quot;Windows Vista&quot;</span>) &gt; -<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (isWinVista) <span class="keyword">return</span> <span class="string">&quot;WinVista&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> isWin7 = sUserAgent.indexOf(<span class="string">&quot;Windows NT 6.1&quot;</span>) &gt; -<span class="number">1</span> || sUserAgent.indexOf(<span class="string">&quot;Windows 7&quot;</span>) &gt; -<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (isWin7) <span class="keyword">return</span> <span class="string">&quot;Win7&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="string">&quot;other&quot;</span>;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><h2 id="ajax全局拦截器"><a href="#ajax全局拦截器" class="headerlink" title="ajax全局拦截器"></a>ajax全局拦截器</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$.ajaxPrefilter( <span class="function"><span class="keyword">function</span>(<span class="params"> options, originalOptions, jqXHR </span>) </span>&#123;</span><br><span class="line"><span class="function"><span class="title">if</span>(<span class="params">options.data</span>)</span>&#123;</span><br><span class="line"><span class="keyword">var</span> params=options.data;</span><br><span class="line"><span class="keyword">return</span> options;</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="替换所有"><a href="#替换所有" class="headerlink" title="替换所有"></a>替换所有</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">String</span>.prototype.replaceAll = <span class="function"><span class="keyword">function</span>(<span class="params">s1, s2</span>) </span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">this</span>.replace(<span class="keyword">new</span> <span class="built_in">RegExp</span>(s1, <span class="string">&quot;gm&quot;</span>), s2);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ping-ip"><a href="#ping-ip" class="headerlink" title="ping ip"></a>ping ip</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ping</span>(<span class="params">ip</span>)</span>&#123;</span><br><span class="line"><span class="keyword">var</span> img = <span class="keyword">new</span> Image();</span><br><span class="line"><span class="keyword">var</span> flag = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">var</span> isCloseWifi = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">var</span> hasFinish = <span class="literal">false</span>;</span><br><span class="line">img.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="comment">// console.log(&quot;success&quot;);</span></span><br><span class="line">&#125;;</span><br><span class="line">img.onerror = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="comment">// console.log(&quot;error&quot;);</span></span><br><span class="line"> </span><br><span class="line">&#125;;</span><br><span class="line">img.src = ip;</span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="comment">// console.log(&quot;timeout&quot;);</span></span><br><span class="line"></span><br><span class="line">&#125;, <span class="number">20000</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="比较2个对象的不同"><a href="#比较2个对象的不同" class="headerlink" title="比较2个对象的不同"></a>比较2个对象的不同</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getObjectDiff</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line"><span class="keyword">var</span> diffObj = &#123;&#125;;</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">Array</span>.isArray(a)) &#123;</span><br><span class="line">a.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">elem, index</span>) </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (!<span class="built_in">Array</span>.isArray(diffObj)) &#123;</span><br><span class="line">diffObj = [];</span><br><span class="line">&#125;</span><br><span class="line">diffObj[index] = getObjectDiff(elem, (b || [])[index]);</span><br><span class="line">&#125;);</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (a != <span class="literal">null</span> &amp;&amp; <span class="keyword">typeof</span> a == <span class="string">&#x27;object&#x27;</span>) &#123;</span><br><span class="line"><span class="built_in">Object</span>.keys(a).forEach(<span class="function"><span class="keyword">function</span>(<span class="params">key</span>) </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">Array</span>.isArray(a[key])) &#123;</span><br><span class="line"><span class="keyword">var</span> arr = getObjectDiff(a[key], b[key]);</span><br><span class="line"><span class="keyword">if</span> (!<span class="built_in">Array</span>.isArray(arr)) &#123;</span><br><span class="line">arr = [];</span><br><span class="line">&#125;</span><br><span class="line">arr.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">elem, index</span>) </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (!<span class="built_in">Array</span>.isArray(diffObj[key])) &#123;</span><br><span class="line">diffObj[key] = [];</span><br><span class="line">&#125;</span><br><span class="line">diffObj[key][index] = elem;</span><br><span class="line">&#125;);</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> a[key] == <span class="string">&#x27;object&#x27;</span>) &#123;</span><br><span class="line">diffObj[key] = getObjectDiff(a[key], b[key]);</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (a[key] != (b || &#123;&#125;)[key]) &#123;</span><br><span class="line">diffObj[key] = a[key];</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (a[key] == (b || &#123;&#125;)[key]) &#123;</span><br><span class="line"><span class="keyword">delete</span> a[key];</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">Object</span>.keys(diffObj).forEach(<span class="function"><span class="keyword">function</span>(<span class="params">key</span>) </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">typeof</span> diffObj[key] == <span class="string">&#x27;object&#x27;</span> &amp;&amp; <span class="built_in">JSON</span>.stringify(diffObj[key]) == <span class="string">&#x27;&#123;&#125;&#x27;</span>) &#123;</span><br><span class="line"><span class="keyword">delete</span> diffObj[key];</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">return</span> diffObj;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="二维数组取交集"><a href="#二维数组取交集" class="headerlink" title="二维数组取交集"></a>二维数组取交集</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.cross = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="keyword">var</span> arrs=<span class="built_in">this</span>;</span><br><span class="line"><span class="keyword">var</span> arr = arrs.shift(); </span><br><span class="line"><span class="function"><span class="title">for</span>(<span class="params"><span class="keyword">var</span> i=arrs.length;i--;</span>)</span>&#123;</span><br><span class="line">   <span class="keyword">var</span> p = &#123;<span class="string">&quot;boolean&quot;</span>:&#123;&#125;, <span class="string">&quot;number&quot;</span>:&#123;&#125;, <span class="string">&quot;string&quot;</span>:&#123;&#125;&#125;, obj = [];</span><br><span class="line">   arr = arr.concat(arrs[i]).filter(<span class="function"><span class="keyword">function</span> (<span class="params">x</span>) </span>&#123;</span><br><span class="line">     <span class="keyword">var</span> t = <span class="keyword">typeof</span> x;</span><br><span class="line">     <span class="keyword">return</span> !((t <span class="keyword">in</span> p) ? !p[t][x] &amp;&amp; (p[t][x] = <span class="number">1</span>) : obj.indexOf(x) &lt; <span class="number">0</span> &amp;&amp; obj.push(x));</span><br><span class="line">   &#125;);</span><br><span class="line">   <span class="keyword">if</span>(!arr.length) <span class="keyword">return</span> <span class="literal">null</span>; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> arr;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> jQuery </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 工具类 </tag>
            
            <tag> 公共方法 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【Pi币教程】PI币注册和认证教程</title>
      <link href="20201208/pi-course/"/>
      <url>20201208/pi-course/</url>
      
        <content type="html"><![CDATA[<h1 id="一、下载Pi-Network-π币-币app"><a href="#一、下载Pi-Network-π币-币app" class="headerlink" title="一、下载Pi Network(π币)币app"></a>一、下载Pi Network(π币)币app</h1><h2 id="（1）安卓手机打开网址下载安装-https-www-lanzous-com-i6q048j"><a href="#（1）安卓手机打开网址下载安装-https-www-lanzous-com-i6q048j" class="headerlink" title="（1）安卓手机打开网址下载安装:https://www.lanzous.com/i6q048j"></a>（1）安卓手机打开网址下载安装:<a href="https://www.lanzous.com/i6q048j">https://www.lanzous.com/i6q048j</a></h2><h2 id="（2）苹果手机："><a href="#（2）苹果手机：" class="headerlink" title="（2）苹果手机："></a>（2）苹果手机：</h2><p>要使用APP Store（非大陆地区）ID才能下载，没有ID的话可以使用下面这个临时香港帐号。<br>在手机App Store中可以切换ID。<br>帐号：<a href="mailto:&#x75;&#x6d;&#50;&#102;&#56;&#x34;&#x31;&#x32;&#64;&#x69;&#x63;&#x6c;&#x6f;&#x75;&#x64;&#x2e;&#99;&#111;&#109;">&#x75;&#x6d;&#50;&#102;&#56;&#x34;&#x31;&#x32;&#64;&#x69;&#x63;&#x6c;&#x6f;&#x75;&#x64;&#x2e;&#99;&#111;&#109;</a><br>密码：Aa112211<br>然后直接在APP Store搜pi network即可直接下载安装；</p><h1 id="二、Pi-Network-π币-币注册认证流程"><a href="#二、Pi-Network-π币-币注册认证流程" class="headerlink" title="二、Pi Network(π币)币注册认证流程"></a>二、Pi Network(π币)币注册认证流程</h1><h2 id="选择手机号注册。"><a href="#选择手机号注册。" class="headerlink" title="选择手机号注册。"></a>选择手机号注册。</h2><p><img src= "/img/loading.gif" data-lazy-src="/img/pi_course_1.jpg" alt="选择手机号注册"></p><h2 id="选择中国-86-输入手机号-点击Go。"><a href="#选择中国-86-输入手机号-点击Go。" class="headerlink" title="选择中国+86,输入手机号,点击Go。"></a>选择中国+86,输入手机号,点击Go。</h2><p><img src= "/img/loading.gif" data-lazy-src="/img/pi_course_2.jpg" alt="选择手机号注册"></p><h2 id="若出现以下界面请耐心等待。"><a href="#若出现以下界面请耐心等待。" class="headerlink" title="若出现以下界面请耐心等待。"></a>若出现以下界面请耐心等待。</h2><p><img src= "/img/loading.gif" data-lazy-src="/img/pi_course_3.jpg" alt="若出现以下界面请耐心等待"></p><h2 id="设置密码和确认密码-两遍密码输入完成后-点击SUBMIT。"><a href="#设置密码和确认密码-两遍密码输入完成后-点击SUBMIT。" class="headerlink" title="设置密码和确认密码,两遍密码输入完成后,点击SUBMIT。"></a>设置密码和确认密码,两遍密码输入完成后,点击SUBMIT。</h2><p><img src= "/img/loading.gif" data-lazy-src="/img/pi_course_4.png" alt="设置密码和确认密码,两遍密码输入完成后,点击SUBMIT"></p><h2 id="输入真实姓名（因为未来上主网需要严格的KYC，如果是虚假姓名，挖的币会被作废）和昵称（也是你的邀请码）-点击SUBMIT。"><a href="#输入真实姓名（因为未来上主网需要严格的KYC，如果是虚假姓名，挖的币会被作废）和昵称（也是你的邀请码）-点击SUBMIT。" class="headerlink" title="输入真实姓名（因为未来上主网需要严格的KYC，如果是虚假姓名，挖的币会被作废）和昵称（也是你的邀请码） ,点击SUBMIT。"></a>输入真实姓名（因为未来上主网需要严格的KYC，如果是虚假姓名，挖的币会被作废）和昵称（也是你的邀请码） ,点击SUBMIT。</h2><p><img src= "/img/loading.gif" data-lazy-src="/img/pi_course_5.png" alt="输入姓名"></p><h2 id="填入邀请人邀请码-onesuperman-点击SUBMIT。"><a href="#填入邀请人邀请码-onesuperman-点击SUBMIT。" class="headerlink" title="填入邀请人邀请码: onesuperman,点击SUBMIT。"></a>填入邀请人邀请码: onesuperman,点击SUBMIT。</h2><p><img src= "/img/loading.gif" data-lazy-src="/img/pi_course_6.png" alt="onesuperman"></p><h2 id="出先引导介绍，一直按提示点击按钮即可。"><a href="#出先引导介绍，一直按提示点击按钮即可。" class="headerlink" title="出先引导介绍，一直按提示点击按钮即可。"></a>出先引导介绍，一直按提示点击按钮即可。</h2><p><img src= "/img/loading.gif" data-lazy-src="/img/pi_course_7.jpg" alt="出先引导介绍，一直按提示点击按钮即可"></p><h2 id="点击左上角的三道杠，弹出菜单栏。"><a href="#点击左上角的三道杠，弹出菜单栏。" class="headerlink" title="点击左上角的三道杠，弹出菜单栏。"></a>点击左上角的三道杠，弹出菜单栏。</h2><p><img src= "/img/loading.gif" data-lazy-src="/img/pi_course_8.jpg" alt="点击左上角的三道杠，弹出菜单栏"></p><h2 id="选择Profile项。"><a href="#选择Profile项。" class="headerlink" title="选择Profile项。"></a>选择Profile项。</h2><p><img src= "/img/loading.gif" data-lazy-src="/img/pi_course_9.jpg" alt="选择Profile项"></p><h2 id="点击倒数第二项的VERIFY。"><a href="#点击倒数第二项的VERIFY。" class="headerlink" title="点击倒数第二项的VERIFY。"></a>点击倒数第二项的VERIFY。</h2><p><img src= "/img/loading.gif" data-lazy-src="/img/pi_course_10.jpg" alt="点击倒数第二项的VERIFY"></p><h2 id="点击绿色的START。"><a href="#点击绿色的START。" class="headerlink" title="点击绿色的START。"></a>点击绿色的START。</h2><p><img src= "/img/loading.gif" data-lazy-src="/img/pi_course_11.jpg" alt="点击绿色的START"></p><h2 id="点击OPEN-SMS。"><a href="#点击OPEN-SMS。" class="headerlink" title="点击OPEN SMS。"></a>点击OPEN SMS。</h2><p><img src= "/img/loading.gif" data-lazy-src="/img/pi_course_12.jpg" alt="点击OPEN SMS"></p><h2 id="发送短信，验证成功。"><a href="#发送短信，验证成功。" class="headerlink" title="发送短信，验证成功。"></a>发送短信，验证成功。</h2><p><img src= "/img/loading.gif" data-lazy-src="/img/pi_course_13.png" alt="发送短信，验证成功"></p><h2 id="显示手机认证成功。"><a href="#显示手机认证成功。" class="headerlink" title="显示手机认证成功。"></a>显示手机认证成功。</h2><p><img src= "/img/loading.gif" data-lazy-src="/img/pi_course_14.jpg" alt="显示手机认证成功"></p><h2 id="如下图，只需要每二十四小时点击一下挖矿按钮即可。注册72小时候开放安全圈，安全圈满五人挖矿算力提升100-。"><a href="#如下图，只需要每二十四小时点击一下挖矿按钮即可。注册72小时候开放安全圈，安全圈满五人挖矿算力提升100-。" class="headerlink" title="如下图，只需要每二十四小时点击一下挖矿按钮即可。注册72小时候开放安全圈，安全圈满五人挖矿算力提升100%。"></a>如下图，只需要每二十四小时点击一下挖矿按钮即可。注册72小时候开放安全圈，安全圈满五人挖矿算力提升100%。</h2><p><img src= "/img/loading.gif" data-lazy-src="/img/pi_course_15.jpg" alt="挖矿"></p><p>温馨提示：<br>1、<strong>记得每24小时内上去点一下【绿色闪电】去收矿！</strong>注册成功72小时以后开启安全圈算力可以100%运行。</p><p>2、未来团队会开发钱包功能，到时候你就可以把币转进你的钱包，由你自己保管。目前挖矿无需任何金钱成本，所以小伙伴们赶快行动起来，抓住项目早期的红利吧！自己的邀请码在菜单里的‘Profile’</p><p>3、注册后一定要进行手机号认证！否则挖的币会被系统销毁。</p><p>4、手机若认证不了，推荐几种解决办法<br>1）、请先认真学习教材，资料，保证操作正确<br>2）、国家和代码是否统一，有的需要手动输入，<br>π币的短信接收方分美国和英国运营商：</p><p>（a）USA美国那边的接收人号码<br>+16508220314 或者写 00+16508220314</p><p>（b）kingdom英国那边接收人号码<br>+447723473314 或者写 00+44772347331<br>尽量用英国服务器通道，最好早上进行认证</p><p>3)、是否是双卡手机，注册号是否和发短信统一</p><p>4)、如果没有认证成功就换时间，换地点多试几次；英国和美国频道交换试</p><p>5)、换手机认证（vo、op部分机型认证不了的请换手机多试几次）<br>6)、手机认证若出现以下错误信息：<br><img src= "/img/loading.gif" data-lazy-src="/img/pi_course_16.png" alt="错误信息"></p><h2 id="以上信息转载于https-www-kancloud-cn-hansomm1-piwakuan-1393996，感谢作者"><a href="#以上信息转载于https-www-kancloud-cn-hansomm1-piwakuan-1393996，感谢作者" class="headerlink" title="以上信息转载于https://www.kancloud.cn/hansomm1/piwakuan/1393996，感谢作者"></a>以上信息转载于<a href="https://www.kancloud.cn/hansomm1/piwakuan/1393996">https://www.kancloud.cn/hansomm1/piwakuan/1393996</a>，感谢作者</h2>]]></content>
      
      
      <categories>
          
          <category> 虚拟货币 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> pi币 </tag>
            
            <tag> 教程 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>工具类开发之excel模板导出（带单选下拉框、多选下拉框、单选下拉级联）</title>
      <link href="20201111/excel-util/"/>
      <url>20201111/excel-util/</url>
      
        <content type="html"><![CDATA[<h1 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h1><p>项目新需求，要求导出excel模板时，某些字段限制手动输入，只能下拉选择数据，并且可以多字段级联选择、多选。于是，借鉴了些大佬的操作，东拼西凑总算将要用到的功能整合到一起了。废话不多说，直接撸代码。</p><h1 id="实现步骤"><a href="#实现步骤" class="headerlink" title="实现步骤"></a>实现步骤</h1><h2 id="先来个配置类自定义注解"><a href="#先来个配置类自定义注解" class="headerlink" title="先来个配置类自定义注解"></a>先来个配置类自定义注解</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span>  </span><br><span class="line"><span class="meta">@Target( &#123; java.lang.annotation.ElementType.FIELD &#125;)</span> </span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> ExcelAnnotation &#123;</span><br><span class="line"> <span class="comment">/** </span></span><br><span class="line"><span class="comment">     * 导出到Excel中的名字. </span></span><br><span class="line"><span class="comment">     */</span>  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> String <span class="title">name</span><span class="params">()</span></span>;  </span><br><span class="line">    <span class="comment">/** </span></span><br><span class="line"><span class="comment">     * 配置列号,对应0，1，2，3.... </span></span><br><span class="line"><span class="comment">     */</span>  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">int</span> <span class="title">column</span><span class="params">()</span></span>;  </span><br><span class="line">    <span class="comment">/** </span></span><br><span class="line"><span class="comment">     * 该字段是否导出 默认true</span></span><br><span class="line"><span class="comment">     */</span>   </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">boolean</span> <span class="title">isExport</span><span class="params">()</span> <span class="keyword">default</span> <span class="keyword">true</span></span>;  </span><br><span class="line">    <span class="comment">/** </span></span><br><span class="line"><span class="comment">     * 表头批注 </span></span><br><span class="line"><span class="comment">     */</span>  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> String <span class="title">prompt</span><span class="params">()</span>  <span class="keyword">default</span> &quot;&quot;</span>;    </span><br><span class="line">    <span class="comment">/** </span></span><br><span class="line"><span class="comment">     * 是否是下拉框</span></span><br><span class="line"><span class="comment">     */</span>  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">boolean</span> <span class="title">isCombo</span><span class="params">()</span>  <span class="keyword">default</span> <span class="keyword">false</span></span>;    </span><br><span class="line">    <span class="comment">/** </span></span><br><span class="line"><span class="comment">     * 父字段列号（下拉框联动）</span></span><br><span class="line"><span class="comment">     */</span>  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">int</span> <span class="title">parentFieldColumn</span><span class="params">()</span>  <span class="keyword">default</span> 0</span>;    </span><br><span class="line">    <span class="comment">/** </span></span><br><span class="line"><span class="comment">     * 下拉框数据</span></span><br><span class="line"><span class="comment">     */</span>  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> String <span class="title">comboValue</span><span class="params">()</span>  <span class="keyword">default</span> &quot;&quot;</span>;    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>将该注解配置到具体实现类上用来配置导出信息，包括导出的字段、字段顺序、表头批注等等，具体使用如下</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FileExportVo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="meta">@ExcelAnnotation(name=&quot;文档路径&quot;,column=0)</span></span><br><span class="line"><span class="keyword">private</span> String filepath;</span><br><span class="line"></span><br><span class="line"><span class="meta">@ExcelAnnotation(name=&quot;文档版本&quot;,column=1,isCombo=true)</span></span><br><span class="line"><span class="keyword">private</span> String fileversion;</span><br><span class="line"></span><br><span class="line"><span class="meta">@ExcelAnnotation(name=&quot;文档描述&quot;,column=2)</span></span><br><span class="line"><span class="keyword">private</span> String filenote;</span><br><span class="line"></span><br><span class="line"><span class="meta">@ExcelAnnotation(name=&quot;文档属性&quot;,column=3,isCombo=true)</span></span><br><span class="line"><span class="keyword">private</span> String filesource;</span><br><span class="line"></span><br><span class="line"><span class="meta">@ExcelAnnotation(name=&quot;所属部门&quot;,column=4,isCombo=true)</span></span><br><span class="line"><span class="keyword">private</span> String dep;</span><br><span class="line"></span><br><span class="line"><span class="meta">@ExcelAnnotation(name=&quot;是否正式文档&quot;,column=5,isCombo=true)</span></span><br><span class="line"><span class="keyword">private</span> String fileflag;</span><br><span class="line"></span><br><span class="line"><span class="meta">@ExcelAnnotation(name=&quot;文档合规属性&quot;,column=6,isCombo=true)</span></span><br><span class="line"><span class="keyword">private</span> String fileproperty; </span><br><span class="line"></span><br><span class="line"><span class="meta">@ExcelAnnotation(name=&quot;文档类型&quot;,column=7,isCombo=true)</span></span><br><span class="line"><span class="keyword">private</span> String typeid;</span><br><span class="line"></span><br><span class="line"><span class="meta">@ExcelAnnotation(name=&quot;作者&quot;,column=8)</span></span><br><span class="line"><span class="keyword">private</span> String author;</span><br><span class="line"><span class="meta">@ExcelAnnotation(name=&quot;文档语言&quot;,column=9,isCombo=true)</span></span><br><span class="line"><span class="keyword">private</span> String filelang;</span><br><span class="line"></span><br><span class="line"><span class="meta">@ExcelAnnotation(name=&quot;适用OS版本&quot;,column=10,isCombo=true)</span></span><br><span class="line"><span class="keyword">private</span> String androidversion;</span><br><span class="line"></span><br><span class="line"><span class="meta">@ExcelAnnotation(name=&quot;文档关键字&quot;,column=11,isCombo=true)</span></span><br><span class="line"><span class="keyword">private</span> String keywords;</span><br><span class="line"></span><br><span class="line"><span class="meta">@ExcelAnnotation(name=&quot;备注&quot;,column=12,isCombo=true)</span></span><br><span class="line"><span class="keyword">private</span> String fileremark;</span><br><span class="line"></span><br><span class="line"><span class="meta">@ExcelAnnotation(name=&quot;文档适用平台&quot;,column=13,isCombo=true)</span></span><br><span class="line"><span class="keyword">private</span> String filechips;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Excel工具类入口"><a href="#Excel工具类入口" class="headerlink" title="Excel工具类入口"></a>Excel工具类入口</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> *  <span class="doctag">@Description</span>:TODO(导出Excel 模板/数据（可配置下拉列表）)</span></span><br><span class="line"><span class="comment"> *  <span class="doctag">@Explain</span> 在实体类字段上添加ExcelAnnotation注解，配置相应信息即可使用</span></span><br><span class="line"><span class="comment"> *  <span class="doctag">@param</span> fileName 导出文件名</span></span><br><span class="line"><span class="comment"> *  <span class="doctag">@param</span> sheetName 工作簿</span></span><br><span class="line"><span class="comment"> *  <span class="doctag">@param</span> clazz 实体对象的Class</span></span><br><span class="line"><span class="comment"> *  <span class="doctag">@param</span> comboParams 参数数据 1、表头提示/下拉框待选数据；</span></span><br><span class="line"><span class="comment"> *  <span class="doctag">@param</span> comboParams 参数数据 2、Map&lt;字段,Map&lt;(prompt/comboValue),Object&gt;；</span></span><br><span class="line"><span class="comment"> *  <span class="doctag">@param</span> comboParams 参数数据 3、comboValue下拉框数据 直接传入对象list；prompt批注直接传入字符串信息即可；</span></span><br><span class="line"><span class="comment"> *  <span class="doctag">@param</span> values 导出数据</span></span><br><span class="line"><span class="comment"> *  <span class="doctag">@param</span> wb wb</span></span><br><span class="line"><span class="comment"> *  <span class="doctag">@param</span> response response</span></span><br><span class="line"><span class="comment"> *  <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> *  <span class="doctag">@throws</span> Exception</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> XSSFWorkbook <span class="title">getXSSFWorkbook</span><span class="params">(String fileName,String sheetName, Class&lt;?&gt; clazz,Map&lt;String,Map&lt;String,Object&gt;&gt; comboParams,List&lt;?&gt; values, XSSFWorkbook wb,HttpServletResponse response)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"><span class="comment">// 第一步，创建一个XSSFWorkbook，对应一个Excel文件</span></span><br><span class="line"><span class="keyword">if</span> (wb == <span class="keyword">null</span>) &#123;</span><br><span class="line">wb = <span class="keyword">new</span> XSSFWorkbook();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 第二步，在workbook中添加一个sheet,对应Excel文件中的sheet</span></span><br><span class="line">XSSFSheet sheet = wb.getSheet(<span class="string">&quot;Sheet1&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 第三步，在sheet中添加表头第0行,注意老版本poi对Excel的行数列数有限制</span></span><br><span class="line">XSSFRow row = sheet.createRow(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 第四步，创建单元格，并设置值表头 设置表头居中</span></span><br><span class="line">XSSFCellStyle style = wb.createCellStyle();</span><br><span class="line">style.setAlignment(HSSFCellStyle.ALIGN_CENTER); <span class="comment">// 创建一个居中格式</span></span><br><span class="line">style.setWrapText(<span class="keyword">true</span>);<span class="comment">// 自动换行</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 声明列对象</span></span><br><span class="line">XSSFCell cell = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//参数数据（下拉框参数，head提示信息）</span></span><br><span class="line"><span class="keyword">if</span>(comboParams!=<span class="keyword">null</span>) &#123;</span><br><span class="line"><span class="keyword">for</span>(String field:comboParams.keySet()) &#123;</span><br><span class="line"><span class="comment">//参数，类型(combo,prompt):数据</span></span><br><span class="line">Map&lt;String,Object&gt; param=comboParams.get(field);</span><br><span class="line"><span class="keyword">for</span>(String type:param.keySet()) &#123;</span><br><span class="line">setClassExcelAnnotation(clazz, field, type, param.get(type));</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//获取字段</span></span><br><span class="line">Field[] fields=clazz.getDeclaredFields();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; fields.length; i++) &#123;  </span><br><span class="line">Field field = fields[i];</span><br><span class="line">ExcelAnnotation attr = field.getAnnotation(ExcelAnnotation.class);  </span><br><span class="line"><span class="keyword">if</span> (attr != <span class="keyword">null</span>) &#123;</span><br><span class="line"><span class="keyword">boolean</span> isExport=attr.isExport();<span class="comment">//是否导出</span></span><br><span class="line"><span class="keyword">if</span>(isExport) &#123;</span><br><span class="line"><span class="keyword">int</span> col = attr.column();<span class="comment">// 获得列号</span></span><br><span class="line">cell = row.createCell(col);<span class="comment">// 创建列  </span></span><br><span class="line">cell.setCellType(HSSFCell.CELL_TYPE_STRING);<span class="comment">// 设置列中写入内容为String类型  </span></span><br><span class="line">cell.setCellValue(attr.name());  </span><br><span class="line"><span class="comment">// 如果设置了提示信息则鼠标放上去提示.  </span></span><br><span class="line"><span class="keyword">if</span> (!attr.prompt().trim().equals(<span class="string">&quot;&quot;</span>)) &#123;</span><br><span class="line">setXSSFPrompt(sheet, attr.prompt(),cell); </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 如果设置了combo属性则本列只能选择或者输入下拉中的内容  </span></span><br><span class="line"><span class="keyword">if</span> (attr.isCombo()) &#123;</span><br><span class="line">setXSSFValidation(sheet,field.getName(),attr,wb);</span><br><span class="line">&#125;  </span><br><span class="line">cell.setCellStyle(style);  </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"> &#125;  </span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建内容</span></span><br><span class="line"><span class="keyword">if</span>(values!=<span class="keyword">null</span>) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; values.size(); i++) &#123;</span><br><span class="line">row = sheet.createRow(i + <span class="number">1</span>);</span><br><span class="line">ExcelAnnotation attr =<span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; fields.length; j++) &#123;  </span><br><span class="line">Field declaredField = fields[j];</span><br><span class="line">attr = declaredField.getAnnotation(ExcelAnnotation.class);  </span><br><span class="line"><span class="keyword">if</span> (attr != <span class="keyword">null</span>) &#123;</span><br><span class="line"><span class="comment">//是否导出</span></span><br><span class="line"><span class="keyword">boolean</span> isExport=attr.isExport();</span><br><span class="line"><span class="keyword">if</span>(isExport) &#123;</span><br><span class="line"><span class="comment">// 获得列号  </span></span><br><span class="line"><span class="keyword">int</span> col = attr.column();</span><br><span class="line">declaredField.setAccessible(<span class="keyword">true</span>);</span><br><span class="line"><span class="comment">//获取数据</span></span><br><span class="line">Object val;</span><br><span class="line">String value = <span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">val = declaredField.get(values.get(i));</span><br><span class="line"><span class="keyword">if</span>(val!=<span class="keyword">null</span>) &#123;</span><br><span class="line"><span class="keyword">if</span>(val.getClass().toString().equals(<span class="string">&quot;class java.util.Date&quot;</span>))&#123;</span><br><span class="line">value=DateUtil.date2StringDate((Date)val);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">value=val.toString();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125; <span class="keyword">catch</span> (IllegalArgumentException e) &#123;</span><br><span class="line">e.printStackTrace();</span><br><span class="line">&#125; <span class="keyword">catch</span> (IllegalAccessException e) &#123;</span><br><span class="line">e.printStackTrace();</span><br><span class="line">&#125;</span><br><span class="line">row.createCell(col).setCellValue(value);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;  </span><br><span class="line">&#125;</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line"><span class="comment">//导出模板 模拟50条空数据</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">50</span>; i++) &#123;</span><br><span class="line">creatAppRow(sheet,i,fields);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//响应到客户端</span></span><br><span class="line"><span class="keyword">if</span>(response!=<span class="keyword">null</span>) &#123;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">setResponseHeader(response, fileName);</span><br><span class="line">OutputStream os = response.getOutputStream();</span><br><span class="line">wb.write(os);</span><br><span class="line">os.flush();</span><br><span class="line">os.close();</span><br><span class="line">&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">e.printStackTrace();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> wb;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="添加下拉数据验证"><a href="#添加下拉数据验证" class="headerlink" title="添加下拉数据验证"></a>添加下拉数据验证</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">/**</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> *  <span class="doctag">@Description</span>:设置下拉数据验证</span></span><br><span class="line"><span class="comment"> *  由于下列是不确定是所以不能保证不超过255故用隐藏页来放置下列信息</span></span><br><span class="line"><span class="comment"> *  <span class="doctag">@param</span> sheet</span></span><br><span class="line"><span class="comment"> *  <span class="doctag">@param</span> textlist</span></span><br><span class="line"><span class="comment"> *  <span class="doctag">@param</span> wb</span></span><br><span class="line"><span class="comment"> *  <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@SuppressWarnings(&quot;unchecked&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">setXSSFValidation</span><span class="params">(XSSFSheet sheet,String fieldName,ExcelAnnotation attr, XSSFWorkbook wb)</span> </span>&#123;</span><br><span class="line"><span class="comment">// 获取所有sheet页个数</span></span><br><span class="line"><span class="keyword">int</span> sheetTotal = wb.getNumberOfSheets();</span><br><span class="line">String hiddenSheetName = <span class="string">&quot;hiddenSheet&quot;</span> + sheetTotal;</span><br><span class="line">XSSFSheet hiddenSheet = wb.createSheet(hiddenSheetName);</span><br><span class="line"><span class="comment">//下拉数据</span></span><br><span class="line">String comboValue=attr.comboValue();</span><br><span class="line">Object obj=JSON.parse(comboValue);</span><br><span class="line">Map&lt;String,Object&gt; comboValues=<span class="keyword">new</span> HashMap&lt;String,Object&gt;();</span><br><span class="line"><span class="keyword">if</span>(obj <span class="keyword">instanceof</span> Map) &#123;</span><br><span class="line">comboValues=(Map&lt;String,Object&gt;) obj;</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">comboValues.put(fieldName, obj);</span><br><span class="line">&#125;</span><br><span class="line">Row row;</span><br><span class="line">Cell cell;</span><br><span class="line">Name name;</span><br><span class="line"><span class="keyword">int</span> i=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (String key : comboValues.keySet()) &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(i==<span class="number">0</span>) &#123;</span><br><span class="line"><span class="comment">//创建一行</span></span><br><span class="line">row = hiddenSheet.createRow(<span class="number">0</span>);</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line"><span class="comment">//获取行</span></span><br><span class="line">row=hiddenSheet.getRow(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//创建列</span></span><br><span class="line">cell = row.createCell(i);</span><br><span class="line"><span class="comment">//给列设置值</span></span><br><span class="line">cell.setCellValue(key);</span><br><span class="line">JSONArray jsonArray=(JSONArray) comboValues.get(key);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= jsonArray.size(); j++) &#123;</span><br><span class="line">row=hiddenSheet.getRow(j);</span><br><span class="line"><span class="keyword">if</span>(row==<span class="keyword">null</span>) &#123;</span><br><span class="line">row=hiddenSheet.createRow(j);</span><br><span class="line">&#125;</span><br><span class="line">cell = row.getCell(i);</span><br><span class="line"><span class="keyword">if</span>(cell==<span class="keyword">null</span>) &#123;</span><br><span class="line">cell = row.createCell(i);</span><br><span class="line">&#125;</span><br><span class="line">Object ob=jsonArray.getObject(j-<span class="number">1</span>, Object.class);</span><br><span class="line">cell.setCellValue((String)ob);</span><br><span class="line">&#125;</span><br><span class="line">name = wb.createName();</span><br><span class="line">name.setNameName(key.toString());</span><br><span class="line">name.setRefersToFormula(hiddenSheetName + <span class="string">&quot;!$&quot;</span>+getcellColumnFlag(i)+<span class="string">&quot;$2:$&quot;</span>+getcellColumnFlag(i)+<span class="string">&quot;$&quot;</span>+(jsonArray.size()+<span class="number">1</span>));</span><br><span class="line">i++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//隐藏数据源</span></span><br><span class="line">wb.setSheetHidden(sheetTotal, <span class="keyword">true</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="创建数据"><a href="#创建数据" class="headerlink" title="创建数据"></a>创建数据</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">/**</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> *  <span class="doctag">@Description</span>:TODO(创建数据)</span></span><br><span class="line"><span class="comment"> *  <span class="doctag">@param</span> xssfSheet sheet</span></span><br><span class="line"><span class="comment"> *  <span class="doctag">@param</span> naturalRowIndex 行标</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">creatAppRow</span><span class="params">(XSSFSheet xssfSheet, <span class="keyword">int</span> naturalRowIndex,Field[] fields)</span> </span>&#123;</span><br><span class="line"><span class="comment">//看有多少下拉框验证 添加验证数据</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; fields.length; i++) &#123;  </span><br><span class="line">Field field = fields[i];</span><br><span class="line">ExcelAnnotation attr = field.getAnnotation(ExcelAnnotation.class);  </span><br><span class="line"><span class="keyword">if</span> (attr != <span class="keyword">null</span>) &#123;</span><br><span class="line"><span class="keyword">boolean</span> isExport=attr.isExport();<span class="comment">//是否导出</span></span><br><span class="line"><span class="keyword">if</span>(isExport) &#123;</span><br><span class="line"><span class="keyword">int</span> col = attr.column();<span class="comment">// 获得列号</span></span><br><span class="line"><span class="keyword">int</span> parentFieldColumn=attr.parentFieldColumn();<span class="comment">//父节点列号</span></span><br><span class="line"><span class="keyword">if</span> (attr.isCombo()) &#123;  </span><br><span class="line"><span class="keyword">if</span>(parentFieldColumn!=<span class="number">0</span>) &#123;</span><br><span class="line"> <span class="comment">//联动</span></span><br><span class="line">DataValidation data_validation = getDataValidationByFormula(xssfSheet,<span class="string">&quot;INDIRECT($&quot;</span>+getcellColumnFlag(parentFieldColumn)+(naturalRowIndex+<span class="number">1</span>)+<span class="string">&quot;)&quot;</span>,naturalRowIndex,col);</span><br><span class="line">xssfSheet.addValidationData(data_validation);</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">DataValidation data_validation = getDataValidationByFormula(xssfSheet,field.getName(), naturalRowIndex, col);</span><br><span class="line">xssfSheet.addValidationData(data_validation);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"> &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="设置数据验证"><a href="#设置数据验证" class="headerlink" title="设置数据验证"></a>设置数据验证</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> *  <span class="doctag">@Description</span>:TODO(使用已定义的数据源方式设置一个数据验证)</span></span><br><span class="line"><span class="comment"> *  <span class="doctag">@param</span> formulaString</span></span><br><span class="line"><span class="comment"> *  <span class="doctag">@param</span> row</span></span><br><span class="line"><span class="comment"> *  <span class="doctag">@param</span> col</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> DataValidation <span class="title">getDataValidationByFormula</span><span class="params">(XSSFSheet xssfSheet,String formulaString,</span></span></span><br><span class="line"><span class="function"><span class="params"><span class="keyword">int</span> row, <span class="keyword">int</span> col)</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 加载下拉列表内容</span></span><br><span class="line">XSSFDataValidationHelper dvHelper = <span class="keyword">new</span> XSSFDataValidationHelper(xssfSheet);</span><br><span class="line">XSSFDataValidationConstraint dvConstraint =(XSSFDataValidationConstraint) dvHelper.createFormulaListConstraint(formulaString);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置数据有效性加载在哪个单元格上。</span></span><br><span class="line"><span class="comment">// 四个参数分别是：起始行、终止行、起始列、终止列</span></span><br><span class="line">CellRangeAddressList regions = <span class="keyword">new</span> CellRangeAddressList(<span class="number">1</span>,<span class="number">65535</span>, col, col);</span><br><span class="line"><span class="comment">// 数据有效性对象</span></span><br><span class="line">XSSFDataValidation data_validation_list =(XSSFDataValidation) dvHelper.createValidation(dvConstraint, regions);</span><br><span class="line"><span class="comment">//禁止手动填写 经测试 直接粘贴也可以</span></span><br><span class="line">data_validation_list.setSuppressDropDownArrow(<span class="keyword">true</span>);</span><br><span class="line">data_validation_list.setShowErrorBox(<span class="keyword">true</span>);</span><br><span class="line"><span class="keyword">return</span> data_validation_list;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> *  <span class="doctag">@Description</span>:TODO(获取列名)</span></span><br><span class="line"><span class="comment"> *  <span class="doctag">@param</span> num 下标</span></span><br><span class="line"><span class="comment"> *  <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> String <span class="title">getcellColumnFlag</span><span class="params">(<span class="keyword">int</span> num)</span> </span>&#123;</span><br><span class="line">String columFiled = <span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="keyword">int</span> chuNum = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> yuNum = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span> (num &gt;= <span class="number">0</span> &amp;&amp; num &lt;= <span class="number">25</span>) &#123;</span><br><span class="line">columFiled = doHandle(num);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">chuNum = (num / <span class="number">26</span>)-<span class="number">1</span>;</span><br><span class="line">yuNum = num % <span class="number">26</span>;</span><br><span class="line"></span><br><span class="line">columFiled += doHandle(chuNum);</span><br><span class="line">columFiled += doHandle(yuNum);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> columFiled;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> String <span class="title">doHandle</span><span class="params">(<span class="keyword">final</span> <span class="keyword">int</span> num)</span> </span>&#123;</span><br><span class="line">String[] charArr = &#123; <span class="string">&quot;A&quot;</span>, <span class="string">&quot;B&quot;</span>, <span class="string">&quot;C&quot;</span>, <span class="string">&quot;D&quot;</span>, <span class="string">&quot;E&quot;</span>, <span class="string">&quot;F&quot;</span>, <span class="string">&quot;G&quot;</span>, <span class="string">&quot;H&quot;</span>, <span class="string">&quot;I&quot;</span>, <span class="string">&quot;J&quot;</span>,</span><br><span class="line"><span class="string">&quot;K&quot;</span>, <span class="string">&quot;L&quot;</span>, <span class="string">&quot;M&quot;</span>, <span class="string">&quot;N&quot;</span>, <span class="string">&quot;O&quot;</span>, <span class="string">&quot;P&quot;</span>, <span class="string">&quot;Q&quot;</span>, <span class="string">&quot;R&quot;</span>, <span class="string">&quot;S&quot;</span>, <span class="string">&quot;T&quot;</span>, <span class="string">&quot;U&quot;</span>, <span class="string">&quot;V&quot;</span>,</span><br><span class="line"><span class="string">&quot;W&quot;</span>, <span class="string">&quot;X&quot;</span>, <span class="string">&quot;Y&quot;</span>, <span class="string">&quot;Z&quot;</span> &#125;;</span><br><span class="line"><span class="keyword">return</span> charArr[num];</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> *  <span class="doctag">@Description</span>:TODO(添加表头批注)</span></span><br><span class="line"><span class="comment"> *  <span class="doctag">@param</span> sheet</span></span><br><span class="line"><span class="comment"> *  <span class="doctag">@param</span> textlist</span></span><br><span class="line"><span class="comment"> *  <span class="doctag">@param</span> cell</span></span><br><span class="line"><span class="comment"> *  <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> XSSFSheet <span class="title">setXSSFPrompt</span><span class="params">(XSSFSheet sheet, String textlist, XSSFCell  cell)</span> </span>&#123;</span><br><span class="line"> <span class="comment">// 创建HSSFPatriarch对象,HSSFPatriarch是所有注释的容器.</span></span><br><span class="line">XSSFDrawing patr = sheet.createDrawingPatriarch();</span><br><span class="line"><span class="comment">// 定义注释的大小和位置,详见文档</span></span><br><span class="line">XSSFComment comment = patr.createCellComment(<span class="keyword">new</span> XSSFClientAnchor(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, (<span class="keyword">short</span>)<span class="number">4</span>, <span class="number">2</span>, (<span class="keyword">short</span>) <span class="number">6</span>, <span class="number">5</span>));</span><br><span class="line"><span class="comment">// 设置注释内容</span></span><br><span class="line">comment.setString(<span class="keyword">new</span> XSSFRichTextString(textlist));</span><br><span class="line"><span class="comment">// 设置注释作者. 当鼠标移动到单元格上是可以在状态栏中看到该内容.</span></span><br><span class="line">cell.setCellComment(comment);<span class="comment">//添加注释</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> sheet;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="反射操作类"><a href="#反射操作类" class="headerlink" title="反射操作类"></a>反射操作类</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> *  <span class="doctag">@Description</span>:TODO(利用反射动态修改注解)</span></span><br><span class="line"><span class="comment"> *  <span class="doctag">@param</span> clazz 类</span></span><br><span class="line"><span class="comment"> *  <span class="doctag">@param</span> declareField 对象字段</span></span><br><span class="line"><span class="comment"> *  <span class="doctag">@param</span> memberKey 注解字段</span></span><br><span class="line"><span class="comment"> *  <span class="doctag">@param</span> memberValue 注解字段 对应的数据</span></span><br><span class="line"><span class="comment"> *  <span class="doctag">@throws</span> Exception</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@SuppressWarnings(&quot;unchecked&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">setClassExcelAnnotation</span><span class="params">(Class&lt;?&gt; clazz, String declareField, String memberKey, Object memberValue)</span></span></span><br><span class="line"><span class="function"><span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">Field declaredField = clazz.getDeclaredField(declareField);</span><br><span class="line">declaredField.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">ExcelAnnotation annotation = declaredField.getAnnotation(ExcelAnnotation.class);</span><br><span class="line"><span class="keyword">if</span> (annotation != <span class="keyword">null</span>) &#123;</span><br><span class="line">InvocationHandler ih = Proxy.getInvocationHandler(annotation);</span><br><span class="line">Field memberValuesField = ih.getClass().getDeclaredField(<span class="string">&quot;memberValues&quot;</span>);</span><br><span class="line">memberValuesField.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">Map&lt;String, Object&gt; memberValues = (Map&lt;String, Object&gt;) memberValuesField.get(ih);</span><br><span class="line"><span class="keyword">if</span>(memberValue <span class="keyword">instanceof</span> String) &#123;</span><br><span class="line"><span class="comment">//参数本身就是字符串（prompt）</span></span><br><span class="line">memberValues.put(memberKey, memberValue);</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line"><span class="comment">//数组/集合类型 需要转成json字符串</span></span><br><span class="line">memberValues.put(memberKey, JSON.toJSONString(memberValue));</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> *  <span class="doctag">@Description</span>:TODO(通过反射的方式获取字段的值)</span></span><br><span class="line"><span class="comment"> *  <span class="doctag">@param</span> clazz 类</span></span><br><span class="line"><span class="comment"> *  <span class="doctag">@param</span> declareField 对象字段</span></span><br><span class="line"><span class="comment"> *  <span class="doctag">@param</span> list 下拉数据</span></span><br><span class="line"><span class="comment"> *  <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> *  <span class="doctag">@throws</span> Exception</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> String[] getClassFieldValueList(Class&lt;?&gt; clazz, String declareField, List&lt;?&gt; list) <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">String[] strArray = <span class="keyword">new</span> String[list.size()];</span><br><span class="line"><span class="keyword">int</span> index = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (Object object : list) &#123;</span><br><span class="line"><span class="comment">//多个字段拼接</span></span><br><span class="line">String declareFields[]=declareField.split(<span class="string">&quot;,&quot;</span>);</span><br><span class="line">String str =<span class="string">&quot;&quot;</span>;</span><br><span class="line">Field declaredField;</span><br><span class="line"><span class="keyword">for</span>(String fields:declareFields) &#123;</span><br><span class="line">declaredField = clazz.getDeclaredField(fields);</span><br><span class="line">declaredField.setAccessible(<span class="keyword">true</span>);</span><br><span class="line"><span class="keyword">if</span>(str.equals(<span class="string">&quot;&quot;</span>)) &#123;</span><br><span class="line">str = declaredField.get(object).toString();</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">str += <span class="string">&quot;(&quot;</span>+declaredField.get(object).toString()+<span class="string">&quot;)&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">strArray[index++] = str;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> strArray;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="多选下拉"><a href="#多选下拉" class="headerlink" title="多选下拉"></a>多选下拉</h1><p>由于多选比较特殊，excel本身只支持单选的，但是我们可以利用‘宏’让Excel支持多选，所以需要先用宏设置好哪些列需要多选，然后导入预先设置好宏的excel模板，然后在它的基础上再实现其他功能即可。</p><h2 id="创建模板"><a href="#创建模板" class="headerlink" title="创建模板"></a>创建模板</h2><p>新建excel 然后打开‘宏’-&gt;创建宏-&gt;编辑代码</p><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> Worksheet_Change(<span class="keyword">ByVal</span> Target <span class="keyword">As</span> Range)</span><br><span class="line"><span class="comment">&#x27;让数据有效性选择 可以多选,不可重复</span></span><br><span class="line"><span class="keyword">Dim</span> rngDV <span class="keyword">As</span> Range</span><br><span class="line"><span class="keyword">Dim</span> oldVal <span class="keyword">As</span> <span class="built_in">String</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Dim</span> newVal <span class="keyword">As</span> <span class="built_in">String</span></span><br><span class="line"><span class="keyword">If</span> Target.Count &gt; <span class="number">1</span> <span class="keyword">Then</span> <span class="keyword">GoTo</span> exitHandler</span><br><span class="line"></span><br><span class="line"><span class="keyword">On</span> <span class="keyword">Error</span> <span class="keyword">Resume</span> <span class="keyword">Next</span></span><br><span class="line"><span class="keyword">Set</span> rngDV = Cells.SpecialCells(xlCellTypeAllValidation)</span><br><span class="line"><span class="keyword">On</span> <span class="keyword">Error</span> <span class="keyword">GoTo</span> exitHandler</span><br><span class="line"></span><br><span class="line"><span class="keyword">If</span> rngDV <span class="keyword">Is</span> <span class="literal">Nothing</span> <span class="keyword">Then</span> <span class="keyword">GoTo</span> exitHandler</span><br><span class="line"></span><br><span class="line"><span class="keyword">If</span> Intersect(Target, rngDV) <span class="keyword">Is</span> <span class="literal">Nothing</span> <span class="keyword">Then</span></span><br><span class="line"><span class="comment">&#x27;do nothing</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Else</span></span><br><span class="line">Application.EnableEvents = <span class="literal">False</span></span><br><span class="line">newVal = Target.Value</span><br><span class="line"><span class="keyword">If</span> Target.Column = <span class="number">11</span> <span class="keyword">Or</span> Target.Column = <span class="number">12</span> <span class="keyword">Or</span> Target.Column = <span class="number">14</span> <span class="keyword">Then</span>  <span class="comment">&#x27;数字是你想要多选的列是多少，多个用or连接。</span></span><br><span class="line">Application.Undo</span><br><span class="line">oldVal = Target.Value</span><br><span class="line">Target.Value = newVal</span><br><span class="line"><span class="keyword">If</span> oldVal = <span class="string">&quot;&quot;</span> <span class="keyword">Then</span></span><br><span class="line"><span class="keyword">Else</span></span><br><span class="line"><span class="keyword">If</span> newVal = <span class="string">&quot;&quot;</span> <span class="keyword">Then</span></span><br><span class="line"><span class="keyword">Else</span> <span class="comment">&#x27;去除重复的字段</span></span><br><span class="line">       <span class="keyword">If</span> InStr(<span class="number">1</span>, oldVal, newVal) &lt;&gt; <span class="number">0</span> <span class="keyword">Then</span></span><br><span class="line">          <span class="keyword">If</span> InStr(<span class="number">1</span>, oldVal, newVal) + Len(newVal) - <span class="number">1</span> = Len(oldVal) <span class="keyword">Then</span> <span class="comment">&#x27;最后一个选项重复</span></span><br><span class="line">            Target.Value = Left(oldVal, Len(oldVal) - Len(newVal) - <span class="number">1</span>)</span><br><span class="line">          <span class="keyword">Else</span></span><br><span class="line">            Target.Value = Replace(oldVal, newVal &amp; <span class="string">&quot;,&quot;</span>, <span class="string">&quot;&quot;</span>) <span class="comment">&#x27;不是最后一个选项重复的时候处理逗号</span></span><br><span class="line">          <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">        <span class="keyword">Else</span> <span class="comment">&#x27;不是重复选项就视同增加选项</span></span><br><span class="line">Target.Value = oldVal _</span><br><span class="line">&amp; <span class="string">&quot;,&quot;</span> &amp; newVal <span class="comment">&#x27;可以是任意符号隔开</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">exitHandler:</span><br><span class="line">Application.EnableEvents = <span class="literal">True</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure><h2 id="调用-导出模板"><a href="#调用-导出模板" class="headerlink" title="调用 导出模板"></a>调用 导出模板</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Map&lt;String,Map&lt;String,Object&gt;&gt;map=<span class="keyword">new</span> HashMap&lt;String, Map&lt;String,Object&gt;&gt;();</span><br><span class="line"><span class="comment">//下拉框数据</span></span><br><span class="line">Map&lt;String,Object&gt;param_chips=<span class="keyword">new</span> HashMap&lt;String, Object&gt;();</span><br><span class="line">List&lt;String&gt;chips=platformChipApproverMapper.selectChipToPdt();</span><br><span class="line">param_chips.put(<span class="string">&quot;comboValue&quot;</span>, chips);</span><br><span class="line">map.put(<span class="string">&quot;filechips&quot;</span>,param_chips);</span><br><span class="line"></span><br><span class="line"><span class="comment">//导入模板 (因为需要多选 所以要先导入一个已经设置好多选的excel模板)</span></span><br><span class="line">InputStream input = <span class="keyword">new</span> FileInputStream(<span class="keyword">new</span> File(EXCEL_TEMPLATE));</span><br><span class="line">XSSFWorkbook workbook=<span class="keyword">new</span> XSSFWorkbook(input);</span><br><span class="line">ExcelUtil.getXSSFWorkbook(<span class="string">&quot;文档批量上传模板&quot;</span>,<span class="string">&quot;Sheet1&quot;</span>, FileExportVo.class, map, <span class="keyword">null</span>, workbook,response);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 工具类 </tag>
            
            <tag> excel </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>html5标签之video与canvas的使用</title>
      <link href="20201110/video-canvas/"/>
      <url>20201110/video-canvas/</url>
      
        <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>最近公司有个项目，需要在线播放视频且需要添加水印，思来想去还是前端实现简单点，特此记录下实现过程，借鉴了下网上的方法，也添加了点自己的东西。</p><h1 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h1><p>需要给播放视频添加水印信息，可以在播放的时候获取到每一帧，然后绘制到canvas画布上，以画布的方式来播放视频（某些情况下可能会有卡顿的情况，如果要求不是很高已经可以满足需要）。</p><h1 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h1><p><img src= "/img/loading.gif" data-lazy-src="/img/blog_video-canvas_1.JPG" alt="html5标签之video与canvas的使用"></p><h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><h2 id="html"><a href="#html" class="headerlink" title="html"></a>html</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">video</span> <span class="attr">id</span>=<span class="string">&quot;video&quot;</span> <span class="attr">src</span>=<span class="string">&quot;http://localhost:8080/projectdemo/video/getFile.do&quot;</span> <span class="attr">style</span>=<span class="string">&quot;display: none;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">video</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">canvas</span> <span class="attr">id</span>=<span class="string">&quot;canvas&quot;</span> <span class="attr">class</span>=<span class="string">&quot;canvas&quot;</span>  <span class="attr">height</span>=<span class="string">&quot;500&quot;</span> <span class="attr">width</span>=<span class="string">&quot;600&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">canvas</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">footer</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;videoPlay&quot;</span>&gt;</span>播放/暂停<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;videoVolumeUp&quot;</span>&gt;</span>音量增大<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;videoVolumeDown&quot;</span>&gt;</span>音量减小<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;fullScreen&quot;</span>&gt;</span>全屏<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">footer</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="js"><a href="#js" class="headerlink" title="js"></a>js</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> vol = <span class="number">0.1</span>;  <span class="comment">//1代表100%音量，每次增减0.1</span></span><br><span class="line"><span class="keyword">var</span> time = <span class="number">10</span>; <span class="comment">//单位秒，每次增减10秒</span></span><br><span class="line"><span class="keyword">var</span> video = <span class="built_in">document</span>.getElementById(<span class="string">&quot;video&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> canvas = <span class="built_in">document</span>.getElementById(<span class="string">&quot;canvas&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> interval = <span class="literal">null</span>;<span class="comment">//视频同步绘制</span></span><br><span class="line"><span class="keyword">var</span> timeFunName=<span class="literal">null</span>;<span class="comment">//单击/双击</span></span><br><span class="line"><span class="keyword">var</span> interstitial =<span class="literal">false</span>;<span class="comment">//控制全屏</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//将视频每一帧绘制到画布上</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">videoToCanvas</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">canvas.getContext(<span class="string">&#x27;2d&#x27;</span>).drawImage(video, <span class="number">0</span>, <span class="number">0</span>, canvas.width, canvas.height);</span><br><span class="line"><span class="comment">// 添加水印</span></span><br><span class="line">createText(canvas.getContext(<span class="string">&#x27;2d&#x27;</span>),<span class="string">&quot;欢迎使用!&quot;</span>,canvas);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//监听视频加载完成时执行</span></span><br><span class="line">video.addEventListener(<span class="string">&#x27;loadeddata&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">videoToCanvas();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//视频播放</span></span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">&quot;videoPlay&quot;</span>).addEventListener(<span class="string">&#x27;click&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">video.paused === <span class="literal">true</span> ? (video.play(),syncDrawing()) : video.pause();</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//音量增大</span></span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">&quot;videoVolumeUp&quot;</span>).addEventListener(<span class="string">&#x27;click&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">(video.volume &gt; <span class="number">1</span> || video.volume == <span class="number">1</span>) ? video.volume = <span class="number">1</span>: video.volume = video.volume + vol;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//音量减小</span></span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">&quot;videoVolumeDown&quot;</span>).addEventListener(<span class="string">&#x27;click&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">(video.volume &lt; <span class="number">0.2</span> || video.volume == <span class="number">0</span>) ? video.volume = <span class="number">0</span>: video.volume = video.volume - vol;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//全屏</span></span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">&quot;fullScreen&quot;</span>).addEventListener(<span class="string">&#x27;click&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">   fullScreen();</span><br><span class="line">&#125;);</span><br><span class="line">canvas.addEventListener(<span class="string">&#x27;click&#x27;</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="comment">//单击 播放或暂停</span></span><br><span class="line"><span class="built_in">clearTimeout</span>(timeFunName); </span><br><span class="line">timeFunName = <span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;                                   </span><br><span class="line">video.paused === <span class="literal">true</span> ? video.play() : video.pause();          </span><br><span class="line">&#125;, <span class="number">300</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line">canvas.addEventListener(<span class="string">&#x27;dblclick&#x27;</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="comment">//双击 全屏</span></span><br><span class="line"><span class="built_in">clearTimeout</span>(timeFunName); </span><br><span class="line"><span class="function"><span class="title">if</span>(<span class="params">interstitial</span>)</span>&#123;</span><br><span class="line">exitFullScreen();</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">fullScreen();</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//视频渲染至画布</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">syncDrawing</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="built_in">clearInterval</span>(interval);</span><br><span class="line">interval = <span class="built_in">window</span>.setInterval(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">   videoToCanvas();</span><br><span class="line">&#125;, <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//键盘事件</span></span><br><span class="line"><span class="built_in">document</span>.onkeyup = <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>&#123;</span><br><span class="line"><span class="keyword">var</span> e = event || <span class="built_in">window</span>.event || <span class="built_in">arguments</span>.callee.caller.arguments[<span class="number">0</span>];</span><br><span class="line"><span class="comment">//鼠标上下键控制视频音量 左右键控制快进后退</span></span><br><span class="line"><span class="keyword">if</span> (e &amp;&amp; e.keyCode === <span class="number">38</span>) &#123;</span><br><span class="line"><span class="comment">// 按 向上键</span></span><br><span class="line">video.volume !== <span class="number">1</span> ? video.volume += vol : <span class="number">1</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (e &amp;&amp; e.keyCode === <span class="number">40</span>) &#123;</span><br><span class="line"><span class="comment">// 按 向下键</span></span><br><span class="line">video.volume !== <span class="number">0</span> ? video.volume -= vol : <span class="number">1</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (e &amp;&amp; e.keyCode === <span class="number">37</span>) &#123;</span><br><span class="line"><span class="comment">// 按 向左键</span></span><br><span class="line">video.currentTime !== <span class="number">0</span> ? video.currentTime -= time : <span class="number">1</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (e &amp;&amp; e.keyCode === <span class="number">39</span>) &#123;</span><br><span class="line"><span class="comment">// 按 向右键</span></span><br><span class="line">video.volume !== video.duration ? video.currentTime += time : <span class="number">1</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (e &amp;&amp; e.keyCode === <span class="number">32</span>) &#123;</span><br><span class="line"><span class="comment">// 按空格键 判断当前是否暂停</span></span><br><span class="line">video.paused === <span class="literal">true</span> ? video.play() : video.pause();</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//添加水印</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createText</span>(<span class="params">ctx,text,canvas</span>)</span>&#123;</span><br><span class="line">ctx.fillStyle = <span class="string">&quot;white&quot;</span>;</span><br><span class="line">ctx.font = <span class="string">&quot;60px &#x27;微软雅黑&#x27;&quot;</span>;</span><br><span class="line">ctx.textAlign = <span class="string">&quot;left&quot;</span>;</span><br><span class="line"><span class="comment">//shadowBlur:模式级数</span></span><br><span class="line">ctx.shadowBlur = <span class="number">10</span>;</span><br><span class="line">ctx.shadowOffsetX = <span class="number">5</span>;</span><br><span class="line">ctx.shadowOffsetY = <span class="number">5</span>;</span><br><span class="line">ctx.shadowColor = <span class="string">&quot;black&quot;</span>;</span><br><span class="line"><span class="comment">//fillText(&quot;要添加的文字&quot;,x0坐标，y0坐标)</span></span><br><span class="line">ctx.fillText(text,canvas.width/<span class="number">2</span>-<span class="number">150</span>,canvas.height/<span class="number">2</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//画布全屏</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fullScreen</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="keyword">var</span> element = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;canvas&#x27;</span>),method = <span class="string">&quot;RequestFullScreen&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> prefixMethod=<span class="literal">null</span>;</span><br><span class="line">[<span class="string">&quot;webkit&quot;</span>, <span class="string">&quot;moz&quot;</span>, <span class="string">&quot;ms&quot;</span>, <span class="string">&quot;o&quot;</span>, <span class="string">&quot;&quot;</span>].forEach(<span class="function"><span class="keyword">function</span>(<span class="params">prefix</span>) </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (prefixMethod) </span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line"><span class="keyword">if</span> (prefix === <span class="string">&quot;&quot;</span>) &#123;</span><br><span class="line"><span class="comment">// 无前缀，方法首字母小写</span></span><br><span class="line">method = method.slice(<span class="number">0</span>,<span class="number">1</span>).toLowerCase() + method.slice(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> fsMethod = <span class="keyword">typeof</span> element[prefix + method];</span><br><span class="line"><span class="keyword">if</span> (fsMethod + <span class="string">&quot;&quot;</span> !== <span class="string">&quot;undefined&quot;</span>) &#123;</span><br><span class="line"><span class="comment">// 如果是函数,则执行该函数</span></span><br><span class="line"><span class="keyword">if</span> (fsMethod === <span class="string">&quot;function&quot;</span>) &#123;</span><br><span class="line">prefixMethod = element[prefix + method]();</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">prefixMethod = element[prefix + method];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">);</span><br><span class="line">interstitial=<span class="literal">true</span>;</span><br><span class="line"><span class="keyword">return</span> prefixMethod;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//退出全屏</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">exitFullScreen</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">de = <span class="built_in">document</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// exit full-screen</span></span><br><span class="line"><span class="keyword">if</span> (de.exitFullscreen) &#123;</span><br><span class="line">de.exitFullscreen();</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (de.webkitExitFullScreen) &#123;</span><br><span class="line">de.webkitExitFullScreen();</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (de.webkitCancelFullScreen) &#123;</span><br><span class="line">de.webkitCancelFullScreen();</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (de.mozCancelFullScreen) &#123;</span><br><span class="line">de.mozCancelFullScreen();</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (de.msExitFullScreen) &#123;</span><br><span class="line">de.msExitFullScreen();</span><br><span class="line">&#125; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="title">catch</span>(<span class="params">err</span>)</span>&#123;</span><br><span class="line">alert(err.description);</span><br><span class="line">&#125;</span><br><span class="line">interstitial=<span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> web前端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> html5 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>开篇</title>
      <link href="20201109/first-word/"/>
      <url>20201109/first-word/</url>
      
        <content type="html"><![CDATA[<h1 id="说点什么"><a href="#说点什么" class="headerlink" title="说点什么"></a>说点什么</h1><p>先简单介绍下自己吧，本人java程序猿一名，<br>前后工作大概5年时间吧，作为一名称职的咸鱼，每天除了老老实实码代码，也没有其他活动了。<br>建站之初完全是一时兴起，想要改变现状找点事做，于是便收集资料找来一个免费的博客框架搭建起来了。<br>至于后期有什么计划，写些什么内容，其实还没具体的规划过，因为有了想法所以开始了。<br>也许是工作中碰到的一些问题的分享，也许是生活游记，想到什么写什么吧。<br>以前也没怎么写过博客，言语枯燥估计也是常态，但是有了一个好的开端，后面逐渐就会好的。<br>一直坚持下去，就好。就这样吧！</p>]]></content>
      
      
      <categories>
          
          <category> 开篇 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 开篇 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
